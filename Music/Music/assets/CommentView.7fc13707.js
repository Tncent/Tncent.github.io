import{_ as e,P as a,a7 as t,r as s,ch as o,j as l,z as n,M as m,N as u,Q as r,R as c,W as i,S as d,U as p,O as g,X as y,Y as C,cl as v,bz as h,aM as f,$ as k,aa as b,a5 as D,a6 as x}from"./index.8c222edc.js";import{S as _}from"./SmallSongData.246ff741.js";import{C as S}from"./index.1addcdf1.js";import{P as j}from"./index.7a5ed3e2.js";import{a as q}from"./headers.9774b89e.js";import{_ as P}from"./Skeleton.2af31e85.js";import"./Select.8d76d25a.js";import"./use-houdini.316adbdf.js";const N=e=>(D("data-v-e14b8477"),e=e(),x(),e),R={class:"comment"},w={key:1,class:"title"},$=N((()=>g("span",{class:"key"},"全部评论",-1))),I={key:2,class:"title"},z=N((()=>g("span",{class:"key"},"缺少必要参数",-1))),B=N((()=>g("br",null,null,-1))),M={key:3,class:"commentData"},V={key:0,class:"hotComments"},O={key:0,class:"loading"},Q={class:"content"},U={class:"allComments",ref:"allCommentsRef"},W={class:"count"},X={key:0,class:"loading"},Y={class:"content"},A=e({__name:"CommentView",setup(e){const D=a(),x=t();let N=s(D.currentRoute.value.query.id),A=s(D.currentRoute.value.query.page?Number(D.currentRoute.value.query.page):1),E=o({hotComments:[],allComments:[]}),F=s(0);const G=(e,a=0)=>{let t=null;E.allComments[0]&&a>=5e3&&(t=E.allComments[E.allComments.length-1].time),v(e,a,t).then((e=>{e.comments&&e.comments[0]?(e.hotComments?E.hotComments=e.hotComments:E.hotComments=[],E.allComments=e.comments,F.value=e.total):($message.info("暂无评论"),D.go(-1)),$mainContent&&$mainContent.scrollIntoView({behavior:"smooth"})}))},H=e=>{D.push({path:"/comment",query:{id:N.value,page:e}})};return l((()=>{N.value&&G(N.value,20*(A.value-1))})),n((()=>D.currentRoute.value),(e=>{e.query.page?A.value=Number(e.query.page):A.value=1,"comment"==e.name&&(N.value=e.query.id,G(e.query.id,20*(A.value-1)))})),(e,a)=>{const t=h,s=f,o=q,l=P;return m(),u("div",R,[r(x).getPlaySongData&&r(x).getPlaySongData.id!=r(N)?(m(),c(t,{key:0,class:"goback",onClick:a[0]||(a[0]=e=>r(D).push(`/comment?id=${r(x).getPlaySongData.id}`)),"content-style":"padding: 6px"},{default:i((()=>[k("前往当前歌曲评论 ")])),_:1})):d("",!0),r(N)?(m(),u("div",w,[$,p(t,{class:"song"},{default:i((()=>[p(_,{getDataByID:r(N)},null,8,["getDataByID"])])),_:1})])):(m(),u("div",I,[z,B,p(s,{strong:"",secondary:"",onClick:a[1]||(a[1]=e=>r(D).go(-1)),style:{"margin-top":"20px"}},{default:i((()=>[k(" 返回上一页 ")])),_:1})])),r(N)&&r(E).allComments[0]?(m(),u("div",M,[r(E).hotComments[0]?(m(),u("div",V,[p(o,{prefix:"bar"},{default:i((()=>[k(" 热门评论 ")])),_:1}),r(E).hotComments[0]?d("",!0):(m(),u("div",O,[p(l,{text:"",repeat:3}),p(l,{text:"",style:{width:"60%"}})])),g("div",Q,[(m(!0),u(y,null,C(r(E).hotComments,(e=>(m(),c(S,{key:e,commentData:e},null,8,["commentData"])))),128))])])):d("",!0),g("div",U,[p(o,{prefix:"bar"},{default:i((()=>[k(" 全部评论 "),g("span",W,b(r(F))+" 条",1)])),_:1}),r(E).allComments[0]?d("",!0):(m(),u("div",X,[p(l,{text:"",repeat:3}),p(l,{text:"",style:{width:"60%"}})])),g("div",Y,[(m(!0),u(y,null,C(r(E).allComments,(e=>(m(),c(S,{key:e,commentData:e},null,8,["commentData"])))),128))])],512),p(j,{totalCount:r(F),pageNumber:r(A),showSizePicker:!1,onPageNumberChange:H},null,8,["totalCount","pageNumber"])])):d("",!0)])}}},[["__scopeId","data-v-e14b8477"]]);export{A as default};
